{"version":3,"sources":["helper/UserMedia.js","helper/RtcPeerHelper.js","helper/SocketHelper.js","screens/CallRoom.jsx","screens/CreateRoom.jsx","Routes.js","index.js"],"names":["getMediaStream","navigator","mediaDevices","getUserMedia","audio","video","then","stream","window","mediaStream","catch","error","alert","message","RtcSender","a","peer","RTCPeerConnection","iceServers","urls","credential","username","getTracks","forEach","track","addTrack","Peer","onicecandidate","e","payload","target","callId","caller","socket","id","ice_candidate","JSON","stringify","candidate","emit","ontrack","remoteStream","document","getElementById","srcObject","onnegotiationneeded","createOffer","offer","setLocalDescription","localDescription","console","ServerCommunication","Promise","resolve","io","connect","userId","on","setRemoteDescription","createAnswer","answer","RtcReceive","RtcSetAnswer","Ice_candidate","addIceCandidate","parse","RtcSetIce_candidate","CallRoom","useParams","VideoTag","useRef","useEffect","init","undefined","MediaStream","current","ref","autoPlay","muted","CreateRoom","history","useHistory","Id","uuid","useState","Value","setValue","InitiateCall","type","placeholder","name","required","onChange","value","onClick","preventDefault","push","Routes","exact","path","component","ReactDOM","render"],"mappings":"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","file":"static/js/main.9d97ec85.chunk.js","sourcesContent":["// for getting the media streams\r\nexport const getMediaStream = () => {\r\n  return navigator.mediaDevices\r\n    .getUserMedia({ audio: true, video: true })\r\n    .then((stream) => {\r\n      window.mediaStream = stream;\r\n      return stream;\r\n    })\r\n    .catch((error) => alert(error.message));\r\n};\r\n","//for RtcPeerConnection\r\nexport const RtcSender = async () => {\r\n  const peer = new RTCPeerConnection({\r\n    iceServers: [\r\n      { urls: \"stun:stun.stunprotocol.org\" },\r\n      {\r\n        urls: \"turn:numb.viagenie.ca\",\r\n        credential: \"muazkh\",\r\n        // n7dKFzczuh5UN7N\r\n        username: \"webrtc@live.com\",\r\n      },\r\n    ],\r\n  });\r\n  await window.mediaStream.getTracks().forEach((track) => {\r\n    peer.addTrack(track, window.mediaStream);\r\n  });\r\n  window.Peer = peer;\r\n  peer.onicecandidate = (e) => {\r\n    const payload = {\r\n      target: window.callId,\r\n      caller: window.socket.id,\r\n      ice_candidate: JSON.stringify(e.candidate),\r\n    };\r\n    window.socket.emit(\"ice_candidate\", payload);\r\n    // console.log(\"Ice Candidate\");\r\n  };\r\n  peer.ontrack = async (e) => {\r\n    // console.log(\"Sender Track\", e);\r\n    await window.remoteStream.addTrack(e.track, window.remoteStream);\r\n    document.getElementById(\"ClintVideoTag\").srcObject = window.remoteStream;\r\n  };\r\n  peer.onnegotiationneeded = (e) => {\r\n    peer\r\n      .createOffer()\r\n      .then((offer) => {\r\n        return peer.setLocalDescription(offer);\r\n      })\r\n      .then(() => {\r\n        const payload = {\r\n          target: window.callId,\r\n          caller: window.socket.id,\r\n          offer: peer.localDescription,\r\n        };\r\n        window.socket.emit(\"offer\", payload);\r\n        // console.log(\"Offer send successfully\");\r\n      })\r\n      .catch((error) =>\r\n        console.error({ message: \"WebRTC localDescription error\", error })\r\n      );\r\n  };\r\n  window.Peer = peer;\r\n};\r\n\r\n//for RtcPeerConnection clint\r\nexport const RtcReceive = ({ offer }) => {\r\n  return new Promise(async (resolve) => {\r\n    const peer = new RTCPeerConnection({\r\n      iceServers: [\r\n        { urls: \"stun:stun.stunprotocol.org\" },\r\n        {\r\n          urls: \"turn:numb.viagenie.ca\",\r\n          credential: \"muazkh\",\r\n          // n7dKFzczuh5UN7N\r\n          username: \"webrtc@live.com\",\r\n        },\r\n      ],\r\n    });\r\n    await window.mediaStream.getTracks().forEach((track) => {\r\n      peer.addTrack(track, window.mediaStream);\r\n    });\r\n    window.Peer = peer;\r\n    peer.onicecandidate = (e) => {\r\n      const payload = {\r\n        target: window.callId,\r\n        caller: window.socket.id,\r\n        ice_candidate: JSON.stringify(e.candidate),\r\n      };\r\n      window.socket.emit(\"ice_candidate\", payload);\r\n      // console.log(\"Ice Candidate\");\r\n    };\r\n    peer.ontrack = async (e) => {\r\n      // console.log(\"Receive Track\", e);\r\n      await window.remoteStream.addTrack(e.track, window.remoteStream);\r\n\r\n      document.getElementById(\"ClintVideoTag\").srcObject = window.remoteStream;\r\n    };\r\n    peer.setRemoteDescription(offer).then((e) => {\r\n      // console.log(\"offer Set Successfully\");\r\n    });\r\n    peer\r\n      .createAnswer()\r\n      .then((answer) => peer.setLocalDescription(answer))\r\n      .then((e) => {\r\n        // console.log(\"Answer created\");\r\n        const payload = {\r\n          target: window.callId,\r\n          caller: window.socket.id,\r\n          answer: peer.localDescription,\r\n        };\r\n        window.socket.emit(\"answer\", payload);\r\n        // console.log(\"Remote answer set successfully\");\r\n        window.Peer = peer;\r\n        resolve(peer);\r\n      })\r\n      .catch((error) =>\r\n        console.error({ message: \"WebRTC localDescription error\", error })\r\n      );\r\n  });\r\n};\r\n\r\n//for RtcPeerConnection clint\r\nexport const RtcSetAnswer = ({ answer }) => {\r\n  window.Peer.setRemoteDescription(answer).then((e) => {\r\n    // console.log(\"remote answer Set Successfully\");\r\n  });\r\n};\r\n\r\n//for Set Ice_candidate\r\nexport const RtcSetIce_candidate = ({ Ice_candidate }) => {\r\n  // console.log(\"Ice_candidate: \", Ice_candidate);\r\n  window.Peer &&\r\n    window.Peer.addIceCandidate(JSON.parse(Ice_candidate.ice_candidate))\r\n      .catch\r\n      // (error) => console.log(\"ERROR Ice_candidate: \", error.message)\r\n      ();\r\n};\r\n","import { io } from \"socket.io-client\";\r\nimport { RtcReceive, RtcSetAnswer, RtcSetIce_candidate } from \"./RtcPeerHelper\";\r\n\r\nexport const ServerCommunication = () => {\r\n  return new Promise((resolve) => {\r\n    const socket = io.connect(\"ws://meet-call.herokuapp.com/\");\r\n    socket.emit(\"join room\", window.callId);\r\n    socket.emit(\"user-two\", (userId) => {\r\n      // console.log(\"UserTwo: \", userId);\r\n    });\r\n    socket.emit(\"user joined\", (userId) => {\r\n      // console.log(\"user joined: \", userId);\r\n    });\r\n    socket.on(\"offer\", (offer) => {\r\n      // console.log(\"got an offer\");\r\n      // window.myPeer\r\n      RtcReceive({ offer: offer });\r\n    });\r\n    socket.on(\"answer\", (answer) => {\r\n      // console.log(\"got an answer\");\r\n      RtcSetAnswer({ answer: answer });\r\n    });\r\n    socket.on(\"ice_candidate\", (Ice_candidate) => {\r\n      // console.log(\"got an ice_candidate\");\r\n      RtcSetIce_candidate({ Ice_candidate: Ice_candidate });\r\n    });\r\n    socket.on(\"connect\", function () {\r\n      window.socket = socket;\r\n      resolve(socket.id);\r\n    });\r\n  });\r\n};\r\n","import { getMediaStream, RtcSender, ServerCommunication } from 'helper';\r\nimport React, { useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router';\r\n\r\nconst CallRoom = () => {\r\n\r\n    const { callId } = useParams()\r\n    const VideoTag = useRef()\r\n\r\n    useEffect(() => {\r\n        init()\r\n        return () => {\r\n            window.mediaStream = undefined;\r\n            window.callId = undefined;\r\n            window.socket = undefined\r\n        }\r\n    })\r\n    \r\n    const init = async () => {\r\n        window.callId = callId;\r\n        window.remoteStream = new MediaStream();\r\n        await getMediaStream()\r\n        VideoTag.current.srcObject = window.mediaStream;\r\n        await ServerCommunication()\r\n        RtcSender()\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <h1>CallRoom : {callId}</h1>\r\n            <video ref={VideoTag} autoPlay muted></video>\r\n            <video id=\"ClintVideoTag\" autoPlay muted></video>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CallRoom;","import { getMediaStream, ServerCommunication } from 'helper';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport { v1 as uuid } from \"uuid\";\r\n// import CR from \"../css/CreateRoom.module.css\";\r\n\r\nconst CreateRoom = () => {\r\n\r\n    const history = useHistory();\r\n\r\n    const VideoTag = useRef()\r\n\r\n    const Id = useRef(uuid())\r\n\r\n    const [Value, setValue] = useState()\r\n\r\n    const InitiateCall = async () => {\r\n        // history.push(`/call/${Id.current}`)\r\n        await getMediaStream();\r\n        window.remoteStream = new MediaStream();\r\n        VideoTag.current.srcObject = window.mediaStream;\r\n        await ServerCommunication()\r\n    }\r\n    const JoinCall = (e) => {\r\n        e.preventDefault()\r\n        history.push(`/call/${Value.callId}`)\r\n    }\r\n\r\n    const onHandelChange = (e) => {\r\n        setValue({...Value, [e.target.name]: e.target.value})\r\n    }\r\n\r\n    useEffect(()=>{\r\n        window.callId = Id.current\r\n        InitiateCall()\r\n    },[])\r\n\r\n    return (\r\n        <div>\r\n            <h1>Shear this Id: {Id.current}</h1>\r\n            <form>\r\n                <input type=\"text\" placeholder=\"Enter Call Id\" name=\"callId\" required onChange={onHandelChange}/>\r\n                <button onClick={JoinCall}>Call</button>\r\n            </form>\r\n            {/* <button onClick={InitiateCall}>Create Call</button> */}\r\n            <video ref={VideoTag} autoPlay muted></video>\r\n            <video id=\"ClintVideoTag\" autoPlay muted></video>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CreateRoom;","import React from \"react\";\r\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\r\nimport CallRoom from \"screens/CallRoom\";\r\nimport CreateRoom from \"screens/CreateRoom\";\r\n\r\nconst Routes = () => {\r\n  return (\r\n    <BrowserRouter>\r\n      <Switch>\r\n        <Route exact path=\"/\" component={CreateRoom} />\r\n        <Route exact path=\"/call/:callId\" component={CallRoom} />\r\n      </Switch>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default Routes;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport Routes from \"Routes\";\r\n\r\nReactDOM.render(<Routes />, document.getElementById(\"root\"));\r\n"],"sourceRoot":""}