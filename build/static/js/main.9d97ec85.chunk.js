(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{55:function(e,n,t){},95:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t(46),a=t.n(c),o=(t(55),t(49)),i=t(1),d=t(4),u=t.n(d),s=t(13),w=function(){return navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(e){return window.mediaStream=e,e})).catch((function(e){return alert(e.message)}))},f=t(47),l=function(){var e=Object(s.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}),e.next=3,window.mediaStream.getTracks().forEach((function(e){n.addTrack(e,window.mediaStream)}));case 3:window.Peer=n,n.onicecandidate=function(e){var n={target:window.callId,caller:window.socket.id,ice_candidate:JSON.stringify(e.candidate)};window.socket.emit("ice_candidate",n)},n.ontrack=function(){var e=Object(s.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.remoteStream.addTrack(n.track,window.remoteStream);case 2:document.getElementById("ClintVideoTag").srcObject=window.remoteStream;case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n.onnegotiationneeded=function(e){n.createOffer().then((function(e){return n.setLocalDescription(e)})).then((function(){var e={target:window.callId,caller:window.socket.id,offer:n.localDescription};window.socket.emit("offer",e)})).catch((function(e){return console.error({message:"WebRTC localDescription error",error:e})}))},window.Peer=n;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){return new Promise((function(e){var n=f.io.connect("ws://meet-call.herokuapp.com/");n.emit("join room",window.callId),n.emit("user-two",(function(e){})),n.emit("user joined",(function(e){})),n.on("offer",(function(e){!function(e){var n=e.offer;new Promise(function(){var e=Object(s.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]}),e.next=3,window.mediaStream.getTracks().forEach((function(e){r.addTrack(e,window.mediaStream)}));case 3:window.Peer=r,r.onicecandidate=function(e){var n={target:window.callId,caller:window.socket.id,ice_candidate:JSON.stringify(e.candidate)};window.socket.emit("ice_candidate",n)},r.ontrack=function(){var e=Object(s.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.remoteStream.addTrack(n.track,window.remoteStream);case 2:document.getElementById("ClintVideoTag").srcObject=window.remoteStream;case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),r.setRemoteDescription(n).then((function(e){})),r.createAnswer().then((function(e){return r.setLocalDescription(e)})).then((function(e){var n={target:window.callId,caller:window.socket.id,answer:r.localDescription};window.socket.emit("answer",n),window.Peer=r,t(r)})).catch((function(e){return console.error({message:"WebRTC localDescription error",error:e})}));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}({offer:e})})),n.on("answer",(function(e){!function(e){var n=e.answer;window.Peer.setRemoteDescription(n).then((function(e){}))}({answer:e})})),n.on("ice_candidate",(function(e){!function(e){var n=e.Ice_candidate;window.Peer&&window.Peer.addIceCandidate(JSON.parse(n.ice_candidate)).catch()}({Ice_candidate:e})})),n.on("connect",(function(){window.socket=n,e(n.id)}))}))},j=t(2),p=function(){var e=Object(i.g)().callId,n=Object(r.useRef)();Object(r.useEffect)((function(){return t(),function(){window.mediaStream=void 0,window.callId=void 0,window.socket=void 0}}));var t=function(){var t=Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.callId=e,window.remoteStream=new MediaStream,t.next=4,w();case 4:return n.current.srcObject=window.mediaStream,t.next=7,m();case 7:l();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(j.jsxs)("div",{children:[Object(j.jsxs)("h1",{children:["CallRoom : ",e]}),Object(j.jsx)("video",{ref:n,autoPlay:!0,muted:!0}),Object(j.jsx)("video",{id:"ClintVideoTag",autoPlay:!0,muted:!0})]})},b=t(21),h=t(29),v=t(50),O=t(97),x=function(){var e=Object(i.f)(),n=Object(r.useRef)(),t=Object(r.useRef)(Object(O.a)()),c=Object(r.useState)(),a=Object(v.a)(c,2),o=a[0],d=a[1],f=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return window.remoteStream=new MediaStream,n.current.srcObject=window.mediaStream,e.next=6,m();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){window.callId=t.current,f()}),[]),Object(j.jsxs)("div",{children:[Object(j.jsxs)("h1",{children:["Shear this Id: ",t.current]}),Object(j.jsxs)("form",{children:[Object(j.jsx)("input",{type:"text",placeholder:"Enter Call Id",name:"callId",required:!0,onChange:function(e){d(Object(h.a)(Object(h.a)({},o),{},Object(b.a)({},e.target.name,e.target.value)))}}),Object(j.jsx)("button",{onClick:function(n){n.preventDefault(),e.push("/call/".concat(o.callId))},children:"Call"})]}),Object(j.jsx)("video",{ref:n,autoPlay:!0,muted:!0}),Object(j.jsx)("video",{id:"ClintVideoTag",autoPlay:!0,muted:!0})]})},k=function(){return Object(j.jsx)(o.a,{children:Object(j.jsxs)(i.c,{children:[Object(j.jsx)(i.a,{exact:!0,path:"/",component:x}),Object(j.jsx)(i.a,{exact:!0,path:"/call/:callId",component:p})]})})};a.a.render(Object(j.jsx)(k,{}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.9d97ec85.chunk.js.map